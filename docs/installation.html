<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>AGCDR - Installation Instructions</title>
	<link rel="stylesheet" type="text/css" media="screen" href="../public/css/stylesheet.css" />
	<link rel="stylesheet" type="text/css" media="print" href="../public/css/print.css" />
</head>

<body>

<div id="frame">

<h1>Asterisk CDR Statistics</h1>

<h2>Installation</h2>

<p><em>This document is under construction.</em></p>

<h3>Pre-requisites</h3>

<p>AGCDR requires the following to run. This list is pretty standard, but please
check it carefully.</p>

<ul>
	<li>Apache 2.2.x server with virtual hosts and mod_rewrite enabled.</li>
	<li>PHP 5.3.3. This is what I've tested it on. It might work on older versions,
	it might not. It definitely won't work on PHP 4.x. Your PHP installation
	will require the MySQL and cURL modules to be compiled.</li>
	<li>Access to a CDR database server used by a PBX that uses
	<a href="http://www.voip-info.org/wiki/view/Asterisk+cdr+mysql">cdr_mysql</a>.</li>
</ul>

<h3>Unpacking and basic setup.</h3>

<p>You're reading this so you've already unpacked the compressed archive. Now move
the contents to wherever you want them to be and ensure that the web server has write
access to the following directories:</p>

<ul>
	<li>data/sm_compile</li>
	<li>data/sm_cache</li>
	<li>data/sm_config</li>
	<li>public/images/charts</li>
</ul>

<h3>Apache server configuration</h3>

<p>AGCDR requires a separate virtual host. The following virtual host configuration
is suitable. Change "*:port" to whichever IP address and port number you wish to use
and change "/path/to/public/dir" to point to the "public" sub-directory of the
un-packed application. Please ensure that you have mod_rewrite enabled.</p>

<pre class="code">&lt;VirtualHost *:port&gt;

        DocumentRoot /path/to/public/dir

        &lt;Directory /path/to/public/dir/>
                Options SymLinksIfOwnerMatch
                AllowOverride All
                Order deny,allow
                allow from all
        &lt;/Directory&gt;

	RewriteEngine On
	RewriteCond %{REQUEST_URI} !^/images/
	RewriteCond %{REQUEST_URI} !^/libraries/
        RewriteCond %{REQUEST_URI} !^/css
        RewriteCond %{REQUEST_URI} !^/js
	RewriteCond %{REQUEST_URI} !^/Favicon.ico
        RewriteRule ^(.*)$ /index.php?route=$1

        ErrorLog /path/to/error.log
        LogLevel debug
        CustomLog /path/to/access.log combined

&lt;/VirtualHost&gt;
</pre>

<p>Given that this software exposes potentially sensitive information regarding
the usage of your PBX you will most likely wish to lock down your virtual host
by IP or by using HTTP auth. AGCDR has no authentication or access control methods
of its own.</p>

<h3>Configuration</h3>

<p>All configuration is done in application/config.php. Edit this file and change
the following as a minimum:</p>

<ol>
	<li>Change the "LIVE_URL" constant to match the virtual host under which
	you have installed AGCDR.</li>
	<li>Add the details of at least one database server which hosts the CDR
	data generated by the cdr_mysql Asterisk module. Complete the fields as
	shown in the demonstration. Ensure that whichever MySQL credentials you
	use have read access to the database server to which they relate.</li>
</ol>

</div>

</body>
</html>